<cons!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Search movies and TV shows">
  <title>Search Results - Cine Realm</title>
  <link rel="stylesheet" href="/style.css">
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">

</head>
<body>
<div id="appIntro">
  <div class="intro-logo">CineRealm</div>
</div>



<header>
  <div class="header-left">
    <h1><a href="/" style="color:#ff2c2c;text-decoration:none;">ðŸŽ¬ Cine Realm</a></h1>
  </div>
  <input type="text" id="searchBar" placeholder="Search movies or shows..." autocomplete="off">
 <nav class="nav-links">
  <a href="/" class="nav-btn">Home</a>
  <a href="/movies" class="nav-btn">Movies</a>
  <a href="/trending" class="nav-btn">Trending</a>
  <a href="/watchlist" class="nav-btn">Watchlist</a>
  <a href="/search" class="nav-btn">Search</a>
</nav>


</header>

<main>
  <section>
    <h2 id="searchTitle">Search Results</h2>
    <div id="searchResults" class="movie-row">
      <p class="placeholder">Enter a search term to find movies and shows</p>
    </div>
  </section>
</main>

<div id="detailsModal" class="modal" style="display:none;">
  <div class="modal-content">
    <span class="close-btn">&times;</span>
    <div id="detailsBody"></div>
  </div>
</div>

<script src="/script.js"></script>
<script>
function getSearchQuery() {
  const urlParams = new URLSearchParams(window.location.search);
  return (urlParams.get("q") || "").trim();
}

async function performSearch(query) {
  const title = document.getElementById("searchTitle");
  const container = document.getElementById("searchResults");
  if (!title || !container) return;

  if (!query) {
    title.textContent = "Search Results";
    container.innerHTML = `<p class="placeholder">Enter a search term to find movies and shows</p>`;
    return;
  }

  title.textContent = `Search Results for "${query}"`;
  container.innerHTML = `<p class="placeholder">Searching...</p>`;

  const data = await apiCall("/search/multi", { query });
  const results = (data?.results || [])
    .filter(x => x.media_type === "movie" || x.media_type === "tv");

  container.innerHTML = "";

  if (!results.length) {
    container.innerHTML = `<p class="placeholder">No results found. Try a different search term.</p>`;
    return;
  }

  // Donâ€™t kill results just because poster_path is missing
  results.forEach(item => {
    if (!item.poster_path && item.backdrop_path) item.poster_path = item.backdrop_path;
    const card = createMovieCard(item, item.media_type);
    if (card) container.appendChild(card);
  });

  if (!container.children.length) {
    container.innerHTML = `<p class="placeholder">No results with posters found.</p>`;
  }
}



document.addEventListener("DOMContentLoaded", () => {
  const q = getSearchQuery();
  const sb = document.getElementById("searchBar");
  if (sb && q) sb.value = q;
  performSearch(q);
});
</script>
</body>
</html>
